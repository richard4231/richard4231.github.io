<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kompetenzradar</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
        .question-card {
            border: 1px solid #e5e7eb;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
        }
        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .meta-info {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
        }
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
        }
        .radio-option:hover {
            background-color: #f3f4f6;
        }
        .slider-container {
            padding: 20px 10px;
            position: relative;
        }
        .slider {
            width: 100%;
            height: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            border-radius: 5px;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: #2563eb;
            border-radius: 50%;
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #2563eb;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.8em;
            color: #666;
        }
        .slider-value {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            color: #2563eb;
        }
        #radarCanvas {
            max-width: 100%;
            height: auto;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 20px;
            height: 10px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Kompetenzradar - Standortbestimmung</h1>
        <div class="grid">
            <div id="questionContainer">
                <!-- Fragen werden hier dynamisch eingefügt -->
            </div>
            <div>
                <canvas id="radarCanvas" width="500" height="500"></canvas>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: rgba(37, 99, 235, 0.6)"></div>
                        <span>Subjektiv</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: rgba(22, 163, 74, 0.6)"></div>
                        <span>Objektiv</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: rgba(220, 38, 38, 0.6)"></div>
                        <span>Interesse</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Konfiguration
        const MIN_WERT = 1;
        const MAX_WERT = 3;
        
        const BEREICHE = [
            "Digitale Grundkompetenzen",
            "Kommunikation & Kollaboration",
            "Sicherheit",
            "Problemlösung",
            "Digitales Lehren & Lernen",
            "Digital Leadership",
            "Digital Administration"
        ];

        const FRAGEN = [
            // Digitale Grundkompetenzen
            {
                id: 1,
                text: "Wie gut beherrschen Sie die grundlegenden Funktionen Ihres Computers/Tablets?",
                bereich: "Digitale Grundkompetenzen",
                ebene: "subjektiv",
                typ: "slider",
                antworten: [
                    { text: "Grundlegend", wert: 1 },
                    { text: "Fortgeschritten", wert: 2 },
                    { text: "Experte", wert: 3 }
                ]
            },
            {
                id: 2,
                text: "Welche dieser Dateitypen ist KEIN Bildformat?",
                bereich: "Digitale Grundkompetenzen",
                ebene: "objektiv",
                typ: "mc",
                antworten: [
                    { text: "JPG", wert: 1 },
                    { text: "PNG", wert: 1 },
                    { text: "DOC", wert: 3 },
                    { text: "GIF", wert: 1 }
                ]
            },
            {
                id: 3,
                text: "Wie stark interessieren Sie sich für neue digitale Werkzeuge und Technologien?",
                bereich: "Digitale Grundkompetenzen",
                ebene: "interesse",
                typ: "slider",
                antworten: [
                    { text: "Gering", wert: 1 },
                    { text: "Mittel", wert: 2 },
                    { text: "Hoch", wert: 3 }
                ]
            },
            // Weitere Fragen...
        ];

        // Globaler State für Antworten
        let antworten = {};

        // Fragen rendern
        function renderFragen() {
            const container = document.getElementById('questionContainer');
            container.innerHTML = FRAGEN.map(frage => {
                if (frage.typ === 'slider') {
                    return `
                        <div class="question-card">
                            <div class="question-title">${frage.text}</div>
                            <div class="meta-info">
                                Bereich: ${frage.bereich} • Ebene: ${frage.ebene}
                            </div>
                            <div class="slider-container">
                                <input 
                                    type="range" 
                                    min="${MIN_WERT}" 
                                    max="${MAX_WERT}" 
                                    step="1"
                                    value="${antworten[frage.id] || MIN_WERT}"
                                    onchange="handleAntwort(${frage.id}, parseInt(this.value))"
                                    oninput="this.nextElementSibling.nextElementSibling.textContent = this.value"
                                    class="slider"
                                >
                                <div class="slider-labels">
                                    ${frage.antworten.map(antwort => `
                                        <span>${antwort.text}</span>
                                    `).join('')}
                                </div>
                                <div class="slider-value">${antworten[frage.id] || MIN_WERT}</div>
                            </div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="question-card">
                            <div class="question-title">${frage.text}</div>
                            <div class="meta-info">
                                Bereich: ${frage.bereich} • Ebene: ${frage.ebene}
                            </div>
                            <div class="radio-group">
                                ${frage.antworten.map((antwort, idx) => `
                                    <label class="radio-option">
                                        <input 
                                            type="radio" 
                                            name="frage-${frage.id}" 
                                            value="${antwort.wert}"
                                            ${antworten[frage.id] === antwort.wert ? 'checked' : ''}
                                            onchange="handleAntwort(${frage.id}, ${antwort.wert})"
                                        >
                                        ${antwort.text}
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }

        // Antwort Handler
        function handleAntwort(fragenId, wert) {
            antworten[fragenId] = wert;
            updateRadar();
        }

        // Radar-Chart zeichnen
        function drawRadar() {
            const canvas = document.getElementById('radarCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 3;

            // Canvas löschen
            ctx.clearRect(0, 0, width, height);

            // Hintergrundlinien zeichnen
            const anzahlBereiche = BEREICHE.length;
            const winkel = (2 * Math.PI) / anzahlBereiche;

            // Hilfslinien
            ctx.beginPath();
            ctx.strokeStyle = '#e5e7eb';
            for (let i = 0; i < anzahlBereiche; i++) {
                const x = centerX + radius * Math.cos(i * winkel - Math.PI / 2);
                const y = centerY + radius * Math.sin(i * winkel - Math.PI / 2);
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Konzentrische Kreise
            for (let r = 1; r <= (MAX_WERT - MIN_WERT); r++) {
                ctx.beginPath();
                ctx.strokeStyle = '#e5e7eb';
                ctx.arc(centerX, centerY, (radius * r) / (MAX_WERT - MIN_WERT), 0, 2 * Math.PI);
                ctx.stroke();
            }

            // Beschriftungen
            ctx.font = '12px Arial';
            ctx.fillStyle = '#000';
            ctx.textAlign = 'center';
            BEREICHE.forEach((bereich, i) => {
                const x = centerX + (radius + 20) * Math.cos(i * winkel - Math.PI / 2);
                const y = centerY + (radius + 20) * Math.sin(i * winkel - Math.PI / 2);
                ctx.fillText(bereich, x, y);
            });

            // Daten aggregieren
            const aggregierteWerte = BEREICHE.reduce((acc, bereich) => {
                acc[bereich] = {
                    subjektiv: [],
                    objektiv: [],
                    interesse: []
                };
                return acc;
            }, {});

            Object.entries(antworten).forEach(([fragenId, wert]) => {
                const frage = FRAGEN.find(f => f.id === parseInt(fragenId));
                if (frage) {
                    aggregierteWerte[frage.bereich][frage.ebene].push(wert);
                }
            });

            // Durchschnitte berechnen
            const chartData = BEREICHE.map(bereich => ({
                bereich,
                subjektiv: durchschnitt(aggregierteWerte[bereich].subjektiv) || MIN_WERT,
                objektiv: durchschnitt(aggregierteWerte[bereich].objektiv) || MIN_WERT,
                interesse: durchschnitt(aggregierteWerte[bereich].interesse) || MIN_WERT
            }));

            // Datenpunkte zeichnen
            const ebenen = ['subjektiv', 'objektiv', 'interesse'];
            const farben = [
                'rgba(37, 99, 235, 0.6)',  // Blau
                'rgba(22, 163, 74, 0.6)',  // Grün
                'rgba(220, 38, 38, 0.6)'   // Rot
            ];

            ebenen.forEach((ebene, ebenenIndex) => {
                const punkte = chartData.map((data, i) => {
                    const normalisierterWert = (data[ebene] - MIN_WERT) / (MAX_WERT - MIN_WERT);
                    return {
                        x: centerX + (radius * normalisierterWert) * Math.cos(i * winkel - Math.PI / 2),
                        y: centerY + (radius * normalisierterWert) * Math.sin(i * winkel - Math.PI / 2)
                    };
                });

                // Bereich zeichnen
                ctx.beginPath();
                ctx.fillStyle = farben[ebenenIndex];
                ctx.strokeStyle = farben[ebenenIndex];
                punkte.forEach((punkt, i) => {
                    if (i === 0) {
                        ctx.moveTo(punkt.x, punkt.y);
                    } else {
                        ctx.lineTo(punkt.x, punkt.y);
                    }
                });
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
            });
        }

        // Hilfsfunktion: Durchschnitt berechnen
        function durchschnitt(werte) {
            if (werte.length === 0) return MIN_WERT;
            return werte.reduce((a, b) => a + b, 0) / werte.length;
        }

        // Update Funktion
        function updateRadar() {
            drawRadar();
        }

        // Initialis